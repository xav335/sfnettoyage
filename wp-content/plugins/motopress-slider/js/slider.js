(function(e,a){a.SliderFormController=a.FormController.extend({},{optionControllers:{},dependencies:{},init:function(a,d){var f=this;this._super(a,d);this.changeShortcode();this.optionControllers.alias.on("change",function(){f.changeShortcode()});e("#mpsl-slider-settings-tabs").tabs()},changeShortcode:function(c){this.optionControllers.shortcode.setValue("["+a.Vars.settings.shortcode_name+" "+this.optionControllers.alias.getValue()+"]")},disableBtns:function(){this.element.find("#update_slider, #delete_slider, #create_slider, #edit_slides").attr("disabled",
"disabled")},enableBtns:function(){this.element.find("#update_slider, #delete_slider, #create_slider, #edit_slides").removeAttr("disabled","disabled")},"#update_slider click":function(c){var d=this;d.disableBtns();if(d.verifyOptions()){c=this.getFormData();c={action:"mpsl_update_slider",nonce:a.Vars.nonces.update_slider,options:JSON.stringify(c)};var f=a.Vars.attrs.id;f&&(c.id=f);e.ajax({type:"POST",url:a.Vars.ajax_url,data:c,success:function(b){d.enableBtns();b.hasOwnProperty("result")&&(!0===b.result?
a.Functions.showMessage(a.Vars.lang.slider_updated,a.Functions.MSG_SUCCESS_TYPE):a.Functions.showMessage(a.Vars.lang.slider_update_error+b.error,a.Functions.MSG_ERROR_TYPE))},error:function(b){b=e.parseJSON(b.responseText);b.debug?console.log(b.message):a.Functions.showMessage(b.message,a.Functions.MSG_ERROR_TYPE);d.enableBtns()},dataType:"JSON"})}else d.enableBtns()},"#create_slider click":function(c){var d=this;d.disableBtns();d.verifyOptions()?(c=d.getFormData(),c={action:"mpsl_create_slider",
nonce:a.Vars.nonces.create_slider,options:JSON.stringify(c)},e.ajax({type:"POST",url:a.Vars.ajax_url,data:c,success:function(c){if(c.hasOwnProperty("result"))if(!0===c.result){a.Functions.showMessage(a.Vars.lang.slider_created,a.Functions.MSG_SUCCESS_TYPE);var b=a.Functions.removeParamFromUrl(window.location.href,"view"),b=a.Functions.addParamsToUrl(b,{view:"slides",id:c.id});window.location.href=b}else a.Functions.showMessage(c.error,a.Functions.MSG_ERROR_TYPE);else a.Functions.showMessage(a.Vars.lang.ajax_result_not_found,
a.Functions.MSG_ERROR_TYPE);d.enableBtns()},error:function(c){var b=e.parseJSON(c.responseText);b.debug?console.log(b.message):a.Functions.showMessage(b.message,a.Functions.MSG_ERROR_TYPE);d.enableBtns();console.error(c)},dataType:"JSON"})):d.enableBtns()},"#delete_slider click":function(c){var d=this;this.disableBtns();c=a.Vars.attrs.id;if(0==confirm(a.Vars.lang.slider_want_delete_single.replace("%d",c)))return!0;var f={action:"mpsl_delete_slider",nonce:a.Vars.nonces.delete_slider};c&&(f.id=c);e.ajax({type:"POST",
url:a.Vars.ajax_url,data:f,success:function(b){d.enableBtns();b.hasOwnProperty("result")?1==b.result?(a.Functions.showMessage(a.Vars.lang.slider_deleted,a.Functions.MSG_SUCCESS_TYPE),b=a.Functions.removeParamsFromUrl(window.location.href,["view","id"]),window.location.href=b):a.Functions.showMessage(b.error,a.Functions.MSG_ERROR_TYPE):a.Functions.showMessage(a.Vars.lang.ajax_result_not_found,a.Functions.MSG_ERROR_TYPE);d.enableBtns()},error:function(b){b=e.parseJSON(b.responseText);b.debug?console.log(b.message):
a.Functions.showMessage(b.message,a.Functions.MSG_ERROR_TYPE);d.enableBtns()},dataType:"JSON"})}});new a.SliderFormController(e(".mpsl-slider-settings-wrapper"))})(jQuery,MPSL);
